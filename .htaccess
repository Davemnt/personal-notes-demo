# ðŸ”’ CONFIGURACIÃ“N DE SEGURIDAD PRIVADA
# Archivo .htaccess para protecciÃ³n adicional

# Prevenir acceso directo a archivos sensibles
<Files "firebase.json">
    Order Allow,Deny
    Deny from all
</Files>

<Files "firestore.rules">
    Order Allow,Deny
    Deny from all
</Files>

<Files "config-security.js">
    Order Allow,Deny
    Deny from all
</Files>

<Files ".env">
    Order Allow,Deny
    Deny from all
</Files>

# Prevenir listado de directorios
Options -Indexes

# Headers de seguridad
<IfModule mod_headers.c>
    # Prevenir iframe embebido
    Header always set X-Frame-Options "DENY"
    
    # Prevenir MIME type sniffing
    Header always set X-Content-Type-Options "nosniff"
    
    # Habilitar XSS protection
    Header always set X-XSS-Protection "1; mode=block"
    
    # PolÃ­tica de referrer estricta
    Header always set Referrer-Policy "no-referrer"
    
    # Cache privado
    Header always set Cache-Control "private, no-cache, no-store, must-revalidate"
    Header always set Pragma "no-cache"
    Header always set Expires "0"
</IfModule>

# Bloquear bots conocidos
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Bloquear bots de bÃºsqueda
    RewriteCond %{HTTP_USER_AGENT} (googlebot|bingbot|slurp|crawl|spider|bot) [NC]
    RewriteRule .* - [F,L]
    
    # Bloquear herramientas de pentesting
    RewriteCond %{HTTP_USER_AGENT} (nikto|sqlmap|nessus|openvas|w3af) [NC]
    RewriteRule .* - [F,L]
</IfModule>